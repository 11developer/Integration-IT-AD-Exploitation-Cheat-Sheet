## USER HUNTING

- Find all machines on the current domain where the current user has local admin access (Get-NetComputer + Invoke-CheckLocalAdminAccess)
```powershell
Find-LocalAdminAccess -Verbose
```
- Find Administrative access
```powershell
. .\Find-PSRemotingLocalAdminAccess.ps1
Find-PSRemotingLocalAdminAccess
# No Stateful
Enter-PSSession -ComputerName targetcomputer.target.domain.local
# Stateful
$sess = New-Pssession -ComputerName targetcomputer.target.domain.local
Enter-Pssession -session $sess
```

- If RPC and SMB are blocked check with WMI
```powershell
. .\Find-WMILocalAdminAccess.ps1
```
- Find local admins on all machines of the domain (Get-NetComputer+Get-
NetLocalGroup)
```powershell
Invoke-EnumerateLocalAdmin -Verbose
```
- Find computers where a domain admin (or specified user/group) has sessions
```powershell
Invoke-UserHunter
Invoke-UserHunter -GroupName "RDPUsers"
```
- Confirm admin access
```powershell
Invoke-UserHunter -CheckAccess
```
- Find computers where a domain admin is logged-in ( Get-NetSession / Get-NetLoggedon )
```powershell
Invoke-UserHunter -Stealth
```
- WAIT FOR INCOMING SESSINON
```powershell
Invoke-UserHunter -ComputerName targetserver -Poll 100 -UserName Administrator -Delay 5 -Verbose
```

[<- BACK TO MAIN MENU ->](https://github.com/Integration-IT/Active-Directory-Exploitation-Cheat-Sheet/blob/master/README.md)